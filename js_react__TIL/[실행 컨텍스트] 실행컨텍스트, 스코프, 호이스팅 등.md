# [실행 컨텍스트] 실행컨텍스트, 스코프, 호이스팅 etc. 작성중

강의: 블로그 및 도서
생성일: 2022년 1월 31일 오후 11:08
수정일: 2022년 2월 1일 오후 1:34
스킬 & 언어: js, 기본 지식

***최종 정리***

- 

***오늘 진도***

- 

---

# **실행컨텍스트**

실행컨텍스트란 실행문맥이라는 의미로 실행할 코드에 제공할 환경 정보를 모아놓은 객체를 뜻한다.

- 동일한 스코프에 있는 코드들을 실행할 때 필요한 환경 정보를 모아 구성하고 이를 콜스택에 쌓아 실행순서를 보장

JS가 활성화될 때 발생되는 현상 (다른 언어에서 발견할 수 없다.)

- 호이스팅
- 외부 환경 정보 구성
- this값 설정

## 콜스택 - 호출스택

전역 공간, 전역 컨텍스트는 자동으로 생성되며, `함수 실행`(가장 일반적인 방법), `eval 함수 실행`, `(ES6+) block생성`을 하면 콜스택에 쌓이게 된다.

- **전역 컨텍스트**

특정함수가 실행되지 않는 한 전역컨텍스트에서 실행되며, 변수 객체를 생성하는 대신 this를 전역객체로 활용

- **함수 컨텍스트**

함수가 실행될 때마다 실행 컨텍스트가 생성, 함수가 동작을 마치면 콜스택에서 삭제된다.

- **eval 함수**

자신만의 실행 컨텍스트를 갖는다.

[다만, eval함수를 사용하지 말라고 한다.](https://developer.mozilla.org/ko/docs/Web/JavaScript/Reference/Global_Objects/eval#eval%EC%9D%84%20%EC%A0%88%EB%8C%80%20%EC%82%AC%EC%9A%A9%ED%95%98%EC%A7%80%20%EB%A7%90%20%EA%B2%83!) **보안에 취약함! + 느림**

### 실행컨텍스트를 구성할 때 생기는 것들

- **`VariableEnvironment`**
    
    ***실행 컨텍스트를 생성할 때 이곳에 먼저 정보를 담은 후 복사하여 LexicalEnvironment를 만든다.***
    
    ✔️ 현재 컨텍스트 내의 변수들에 대한 정보
    
    ✔️ 외부 환경 정보
    
    ✔️ (변경사항이 반영되지 않은) 선언 시점의 LexicalEnvironment 스냅샷
    
- **`LexicalEnvironment`**
    
    ***environmentRecord(로 인하여 호이스팅 발생)와 outerEnvironmentRerence(스코츠와 스코프 체인이 형성)로 구성되어 있다.***
    
    ✔️ VariableEnvironment 복사
    
    ✔️ 변경사항이 실시간으로 반영됨
    
- **`ThisBinding`**
    
    ✔️ 변수(식별자)가 바라봐야할 대상 객체
    

### **environmentRecord와 호이스팅**

**JS는 코드를 실행하기 전 변수를 수집한다.** → 코드가 실행되기 전 JS엔진은 실행 컨텍스트에 포함된 모든 변수명을 알고 있다는 뜻으로 JS엔진이 **실제로 변수를 최상단으로 끌어올리는 것은 아니나 마치 끌어올리는 것처럼 동작**한다.

- ***environmentRecord** (매개변수 식별자, 함수 자체, 함수의 내부 식별자)*
- ***Host Object***
    - 전역 실행 컨텍스트는 변수 객체를 생성하는 대신 전역 객체 활용(window 객체, Node의 Global객체)

변수의 호이스팅 현상은 `var x;` 와 같이 값이 할당되는 곳이 아닌 변수를 선언하는 부분이 호이스팅되나 함수의 호이스팅은 함수 전체가 호이스팅된다. → 그렇기 때문에 함수 선언식이 아닌 함수 표현식을 사용하는 것이 오류를 줄일 수 있다.

### **outerEnvironmentRerence와 스코프**

- **scope**

스코프란 식별자에 대한 유효범위다. (전역변수, 지역변수의 개념)

JS에서 ES5까지의 스코프 개념은 오직 함수에 의해서만 생성되었다.

- **scope chain**

식별자의 유효범위(스코프)를 밖에서부터 차례로 검색해 나가는 것

선언이 발생되는 시점은 콜스택상에 실행 컨텍스트가 활성화된 상태일 때. (모든 코드는 실행 컨텍스트가 활성화된 상태일 때 실행된다.)

여러 scope chain에서 동일한 식별자를 선언할 때, 가장 먼저 발견된 식별자에만 접근이 가능하다.